---
# Default variables for openmanet-image role
#
# Note: This role builds firmware on a REMOTE build server.
# All build tasks are delegated to the build server via SSH.
# Configure build server connection in group_vars/all.yml or inventory.

# Build server connection details (REMOTE server)
openwrt_build_server: "{{ build_server_host | default('localhost') }}"
openwrt_build_user: "{{ build_server_user | default('ubuntu') }}"
openwrt_build_ssh_key: "{{ build_ssh_key | default('~/.ssh/id_rsa_proxmox_vms') }}"
openwrt_build_path: "{{ build_server_path | default('/home/ubuntu/source/openwrt/') }}"

# Repository configuration
openwrt_repo_url: "https://github.com/OpenMANET/openwrt.git"
openwrt_repo_branch: "release-1.5"  # Can be overridden: release-1.5, release-1.4.1, mm/v23.05.5, etc.
openwrt_repo_dir: "{{ openwrt_build_path }}"

# Build configuration
openwrt_build_config: "ekh01"  # Morse setup build config identifier
openwrt_build_jobs: "16"  # Number of parallel build jobs (-jN) - default 16 cores
openwrt_build_verbose: "sc"  # Verbose level: sc, 1, 0

# Target path for docker_diffconfig on build server
openwrt_diffconfig_path: "{{ openwrt_repo_dir }}boards/common/docker_diffconfig"

# Local paths for build artifacts
openwrt_local_artifacts_dir: "{{ playbook_dir }}/../../artifacts/openwrt"
openwrt_local_build_log: "{{ openwrt_local_artifacts_dir }}/build.log"

# Flash configuration
# Note: If both are empty and artifacts exist, openwrt_flash_image_local will be set automatically
# from the first firmware image found in {{ openwrt_local_artifacts_dir }}
openwrt_flash_image_path: ""  # Path to firmware image on device (e.g., /tmp/firmware.img.gz)
openwrt_flash_image_local: ""  # Local path on Ansible control machine (auto-detected from artifacts if empty)
openwrt_flash_keep_settings: true  # Preserve settings during flash (sysupgrade -k)
openwrt_flash_device_path: "/tmp/firmware.img.gz"  # Temporary path on device for transferred firmware image
